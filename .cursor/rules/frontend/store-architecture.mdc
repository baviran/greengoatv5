# Store Architecture Rules

## ðŸŸ  Store Architecture Standards

### Unified Store Usage
- **Always use the new unified store structure**
- **Never use old individual store imports**
- **Use app store composition for all state management**
- **Follow domain-specific store patterns**

### Store Import Patterns
```typescript
// âœ… Good - unified store usage
import { useAppStore, useAppChat, useAppSelector } from '@/app/lib/store/appStore';

// âœ… Good - domain-specific hooks
const { activeThreadId, sendMessage } = useAppChat();

// âœ… Good - performance-optimized selectors
const isLoading = useAppSelector(store => store.loading.globalLoading);

// âŒ Bad - old individual store imports
import { useChatStore } from './lib/store/chatStore';
import { useThemeStore } from './lib/store/themeStore';
```

### Store Initialization Rules
```typescript
// âœ… Good - app-level initialization
const { manager } = useAppStore();

useEffect(() => {
  manager.initialize();
}, [manager]);

// âŒ Bad - manual store initialization
useEffect(() => {
  initializeTheme();
  initializeStore();
}, [initializeTheme, initializeStore]);
```

### Performance-Optimized State Access
```typescript
// âœ… Good - memoized selectors
const activeThread = useAppSelector(store => 
  store.chat.activeThreadId 
    ? store.chat.threads.find(t => t.id === store.chat.activeThreadId)
    : null
);

// âœ… Good - domain-specific hooks for performance
const { activeThreadId, sendMessage } = useAppChat();

// âŒ Bad - accessing entire store unnecessarily
const { chat, ui, shared } = useAppStore();
```

### Store Event Handling
```typescript
// âœ… Good - use app actions for cross-store operations
import { appActions } from '@/app/lib/store/appStore';

const showSuccessMessage = (message: string) => {
  appActions.showSuccess('Success', message);
};

// âŒ Bad - direct store manipulation
const authStore = useAuthStore.getState();
await authStore.signOut();
```

### Store Cleanup Rules
```typescript
// âœ… Good - proper cleanup
useEffect(() => {
  return () => {
    // Cleanup is handled automatically by app store manager
  };
}, []);

// âœ… Good - explicit reset when needed
const { manager } = useAppStore();
const handleReset = async () => {
  await manager.reset();
};
```

### Domain Store Guidelines



#### Chat Domain
```typescript
// âœ… Good - chat operations
const { 
  activeThreadId, 
  threads, 
  sendMessage, 
  createNewThread,
  setActiveThread 
} = useAppChat();

// Use chat store for all chat operations
```

#### UI Domain
```typescript
// âœ… Good - UI state management
const theme = useAppSelector(store => store.theme.theme);
const notifications = useAppSelector(store => store.notification.notifications);

// Use app actions for UI operations
appActions.toggleTheme();
appActions.showSuccess('Title', 'Message');
```

@store-template.ts
